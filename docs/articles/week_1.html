<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="datascience.curriculum">
<title>Week 1:  Setting Up • datascience.curriculum</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Week 1:  Setting Up">
<meta property="og:description" content="datascience.curriculum">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">datascience.curriculum</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9005</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/week_1.html">Week 1:  Setting Up</a>
    <a class="dropdown-item" href="../articles/week_2.html">Week 2:  R Fundamentals</a>
    <a class="dropdown-item" href="../articles/week_3.html">Week 3:  Next Level R</a>
    <a class="dropdown-item" href="../articles/week_6.html">Week 6:  Packages</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Week 1:  Setting Up</h1>
            
      
      
      <div class="d-none name"><code>week_1.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This course will focus on what I believe are the essential skills
necessary for a laboratory-based scientist to use R and Rstudio in an
effective way. There are many other detailed resources out there for
you.</p>
<ul>
<li>
<a href="https://software-carpentry.org/lessons/previous/" class="external-link">Software
carpentry</a> has very good tutorials for R, python, git and working
with the command line.<br>
</li>
<li>
<a href="https://r4ds.had.co.nz/" class="external-link">R for data science</a> is a book
written by Hadley Wickham who wrote much of the software we use in
R</li>
<li>
<a href="https://moderndive.com/" class="external-link">Modern dive</a> is focused on
modeling if you are interested in more clinical data sets</li>
</ul>
<p>These and many others are good resources if you want to extend your
knowledge beyond what we cover here.</p>
<p>Learning R at times will seem like learning a foreign language. You
will make errors. <strong>Always remember that you will never be the
first person to encounter an error. Learn how to google the error
message and 99% of the time you will find your answer in the first 3
hits</strong>. This is how you learn.</p>
</div>
<div class="section level2">
<h2 id="r-and-rstudio">R and Rstudio<a class="anchor" aria-label="anchor" href="#r-and-rstudio"></a>
</h2>
<p>R is a statistical programming language that runs as a computer
program. Rstudio is known as an integrated development environment or
IDE. It is the standard way humans interact with the R program.</p>
<p>Rstudio provides two main ways of interacting with R: directly via
the R Console and via R scripts.</p>
<ul>
<li>
<p>R console: you type in commands and output is usually returned to
the console. The commands are logged in a history file if you really
need them, but this is inconvenient. A better option is to use
scripts.</p>
<p><strong>Warning and Error messages will appear in the console. Always
pay attention to what they are saying.</strong></p>
</li>
<li>
<p>R scripts: these are text files, usually in the form of
<filename>.R. When you run 1 or more lines, Rstudio feeds them into the
console and R follows the commands. This is good because you always have
a plain text record of what you did. So when you build up a multi-step
analysis it is easy to see how you got the end product. Better than
running the whole file line by line is “sourcing” the file. You can do
this by typing Ctrl+Shift+S or clicking the “Source” button in the upper
right corner of the source pane (usually top-left) in Rstudio. Why is
this better? Let’s say you left an error in your script. Maybe the
presence of this error changes the final output you are trying to
produce. If you run all of the lines, R will notify you of the error and
then keep going. Easy to miss if this is the only error. If you source
the file, it will stop completely on errors so you don’t end up with
errors you aren’t aware of.</filename></p>
<p><strong>You always want your programs to error in obvious ways so you
don’t carry on with incorrect data.</strong></p>
</li>
</ul>
<p>Rstudio provides a number of standard panes that display useful
information. We will review these in class or you can explore them on
your own.</p>
<p>By default, R studio gives you the option to save your workspace data
when you close out a session and then to reload your workspace from that
file the next time you start to work. This is generally not a good idea,
for reasons we will see. It wastes time loading and quitting sessions
and you want to be explicit in what objects you are saving, if and when
you save them.</p>
<p>To turn this off, go to the Rstudio menu bar, select Tools, then
Global Options. Make the following selections in the pop-up window:</p>
<div class="figure">
<img src="images/rstudio_opts.png" style="width:100.0%" alt=""><p class="caption">R studio workspace options</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-your-system">Setting up your system<a class="anchor" aria-label="anchor" href="#setting-up-your-system"></a>
</h2>
<p>I recommend this approach to setting up your R installation. In
comparison to other methods, the blaseRtemplates method provides greater
transparency and reproducibility and an improved user experience
(faster, fewer confusing messages). But your mileage may vary.</p>
<p>First, install the blaseRtemplates package using whatever package
installer you currently use. Assuming the base install function,
run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'blaseRtemplates'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://blaserlab.r-universe.dev'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, simply run the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/blaserlab/blaseRtemplates" class="external-link">"blaseRtemplates"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/establish_new_bt.html" class="external-link">establish_new_bt</a></span><span class="op">(</span>cache_path <span class="op">=</span> <span class="st">"&lt;some_directory&gt;/r_4_2_cache"</span>, project_path <span class="op">=</span> <span class="st">"&lt;some_directory&gt;/projects"</span><span class="op">)</span></span></code></pre></div>
<p>What will this do?</p>
<ul>
<li>It will create directories where indicated, write a standard
.Rprofile document, and modify the user .Renviron file to configure R
properly.<br>
</li>
<li>It will not overwrite existing directories and will fail when an
existing installation is already present in the same location.<br>
</li>
<li>The only modification outside of the provided directory is to the
.Renviron file. If you have existing configurations in your .Renviron
file, they will only be changed if they are conflicting. If this is
problematic, then you should archive your .Renviron file before running.
The new .Renviron file will cause R to use the new .Rprofile in the
cache directory and skip existing user- and project-level
.Rprofiles.</li>
</ul>
<p>Briefly, when R starts a new session, it looks for a series of files
to configure itself. This configuration includes environment variables
(in the .Renviron file) and any desired R code (in the .Rprofile file).
As included in this function, these configurations only affect user
experience i.e. they should not affect the results produced by your
code. By user experience I mean connection to the proper package
libraries and repositories and some safeguards to prevent working
outside of projects.</p>
<p>For more information on how R starts, see <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html" title="R startup" class="external-link">this link.</a>.</p>
<div class="section level3">
<h3 id="directory-structure">Directory Structure<a class="anchor" aria-label="anchor" href="#directory-structure"></a>
</h3>
<pre><code>.
|-- projects
|   `-- baseproject
`-- r_4_2_cache
    |-- library
    |-- logs
    |-- source
    |-- user_project
    |-- dependency_catalog.tsv
    |-- package_catalog.tsv
    `-- .Rprofile</code></pre>
<p>First, note that two main subdirectories have been created in one
parent directory. This is optional and can be specified by the function
inputs, but for a single user system it is recommended to keep them
together for the sake of organization.</p>
<ul>
<li><p>projects: where your projects should be initialized. They can go
anywhere but you should keep them here. The baseproject is created by
the establish_new_bt function. If you close a project without moving to
a new one or try to start a session outside of a project, it will bounce
you here. This prevents undesired operations in e.g. the home directory
or elsewhere.</p></li>
<li>
<p>r_4_2_cache: This holds all of the inner workings of the
blaseRtemplates system.</p>
<ul>
<li><p>library: The versioned/hashed package binary cache. Each package
is stored under the following rubric: name &gt; version &gt; hash &gt;
name &gt; contents. This structure is generated whenever blaseRtemplates
installs a new package in any project.</p></li>
<li><p>logs: collection of .Rhistory files. Rather than 1 endless file
(default), blaseRtemplates will store history files for each session by
user and date/time</p></li>
<li><p>source: Package source files. Used by the installer,
pak.</p></li>
<li><p>user_project: A collection of symlinks to versioned/hashed
packages in the library. This is identified as the first entry in
.libPaths() so it is where R looks first for packages. Why do this? 1.
It allows reproducibility. If I update a package for one project, it may
break something in an older project. This allows each project to have
its own set of packages. (The list of what versions are used is kept as
a tsv file within the project, so it is completely portable. Anyone who
wants to replicate your code just has to install that list of packages.)
2. It makes the system lightweight. Package code and more significantly,
data, is stored in one location and accessible to many projects,
according to version.</p></li>
<li><p>dependency_catalog.tsv: a list of package dependencies by package
hash. Speeds up installation when linking packages from the cache to a
project.</p></li>
<li><p>package_catalog.tsv: the master catalog of packages available in
the cache.</p></li>
<li><p>.Rprofile: the Rprofile used on startup, as specified by the new
.Renviron file</p></li>
</ul>
</li>
</ul>
<p>The library directory is initially populated using all packages
available to R the local libraries. Depending on what is in those
libraries, and processing/network speeds, this may take some time.</p>
</div>
</div>
<div class="section level2">
<h2 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h2>
<p>A project is a self-contained group of files for your R data
analysis. This should align conceptually with your experiments. If you
have a set of single cell data and imaging data related to the same
scientific concept or paper then it can all go in the same project.</p>
<p>Projects automatically define their working directory to be the root
of the projects. That means you can reference any file in the root
directory by typing its name like so: “file.R”. If that file was one
directory down, it would be “directory/file.R”. There is almost no good
reason ever to change your working directory to something other than the
project root.</p>
<p>You always want to be working in a project.</p>
<div class="section level3">
<h3 id="setting-up-a-project">Setting up a project<a class="anchor" aria-label="anchor" href="#setting-up-a-project"></a>
</h3>
<p>The best way to do this is through automated commands, rather than
through the program menus. This way the packages are set up in a
consistent manner, every time. Then when you have to revisit a project
after months and months, it is easy to navigate.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a project called rclass_project_2023 in your projects directory</span></span>
<span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/initialize_project.html" class="external-link">initialize_project</a></span><span class="op">(</span><span class="st">"&lt;projects directory&gt;/rclass_project_2023"</span><span class="op">)</span></span></code></pre></div>
<p>That function will create the skeletonized project, activate it and
restart your session within it.</p>
<p>The following lines are taken directly from one of files created,
“R/inititialization.R”. You should run these when you start up the
project the first time:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># after running the initialization command, run these lines once to set up</span></span>
<span><span class="co"># your project in a consistent manner.</span></span>
<span><span class="co"># private github repos can be made public via the web interface</span></span>
<span></span>
<span><span class="co"># make a software license</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/licenses.html" class="external-link">use_mit_license</a></span><span class="op">(</span><span class="st">"&lt;your name here&gt;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate a readme file to explain your work</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_readme_rmd.html" class="external-link">use_readme_md</a></span><span class="op">(</span>open <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># *** Only if developing a package ***</span></span>
<span><span class="co"># uncomment and run to generate a news file to document updates.</span></span>
<span><span class="co"># usethis::use_news_md()</span></span>
<span></span>
<span><span class="co"># initialize git</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_git.html" class="external-link">use_git</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize github</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_github.html" class="external-link">use_github</a></span><span class="op">(</span>private <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">### Delete this file after initializing the project! ###</span></span></code></pre></div>
<p>After you run this script, you should delete it. See below for
setting up git and github for the first time.</p>
</div>
<div class="section level3">
<h3 id="project-organization">Project organization<a class="anchor" aria-label="anchor" href="#project-organization"></a>
</h3>
<p>I keep all of my R scripts in a directory called “R”. If you
initialized your project with
<code><a href="https://blaserlab.github.io/blaseRtemplates/reference/initialize_project.html" class="external-link">blaseRtemplates::initialize_project()</a></code>, in addition to
<code>initialize.R</code>, you will have scripts labeled:</p>
<ul>
<li>
<code>dependencies.R</code>: use this for installing packages into
your renv environment and attaching them to your session</li>
<li>
<code>configs.R</code>: use this for setting graphical and aesthetic
parameters. I also use this for resolving function name conflicts.</li>
<li>
<code>git_commands.R</code>: only necessary if you are using git
(recommended). The commands here will allow you to handle 99% of git
interactions via R in a scripted way.</li>
</ul>
<p>In addition to this, the main analysis scripts for the project will
go in the R folder and may go in subdirectories if there are a lot of
them. Other file types, such as *.Rmd, would go in their own folder
named Rmd/. This arrangement is very flexible for simple data analysis
projects; the rules become more strict when we build packages.</p>
</div>
</div>
<div class="section level2">
<h2 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h2>
<p>Packages are chunks of code and/or data that people have written and
made available to us to use. The main reason we use R is that there is a
large library of useful packages for the biological sciences that we can
build our work on, all of which are free to use.</p>
<p>Packages are most often stored and distributed via standard
repositories. The most common are <a href="https://cran.r-project.org/" class="external-link">CRAN</a>, <a href="https://r-universe.dev/search/" class="external-link">R-universe</a>, and <a href="https://www.bioconductor.org/" class="external-link">Bioconductor</a>. Packages can also
be distributed as source code (text based files), usually via
github.</p>
<p><strong>What happens when we “install” packages?</strong></p>
<p>R downloads the compressed file and then unpacks it in a library
directory on your computer or server. IF you are installing from source
code (most linux computers or github repositories), then the code needs
to be turned into a set of binary instructions for the computer to use,
a process called compiling. This is what the Xcode (Mac) and RTools
(Win) programs do.</p>
<p>Every time you start an R session, a set of commands is run that
points R to one or more library directories. This is how R finds the
commands you ask it to use. Unfortunately, it can be difficult to find
where these directories live, depending on your installation. To help
with this, I have developed a package management system, called
blaseRtemplates, that we will use in this course (see below).</p>
<p><strong>How do I use a function?</strong></p>
<p>Once you have installed a package, its functions are available to be
called using the package name followed by 2 colons such as
<code>dplyr::filter(mtcars, cyl == 6)</code>. But this is not always the
best way to go.</p>
<p>To make all of the functions from a package available, you need to
run <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library("&lt;package name&gt;")</a></code>. This will attach all
of the functions from that package to your session. Then you can just
use the function name without the package prefix.</p>
<p>Beware of attaching more packages than you actually need though
because there could be “namespace conflicts”. This happens when the same
term applies to two different functions from two different packages. R
picks one and goes with it without clearly indicating that it is doing
so. This is a common source of errors.</p>
<p>Later on we will see how to use the “conflicted” package to help warn
us of those errors before they cause a problem.</p>
<p><strong>Where do I look for help with R functions?</strong></p>
<p>A manual for each function in an R package is generated and can be
viewed in the help panel in RStudio. Access these with
<code>?&lt;object name&gt;</code> e.g. <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">?mean</a></code>. Vignettes may
also be available. Vignettes are long-form articles that show you how to
use the functions in a package together, often with example data. These
are best accessed by navigating through the package menu. Click on the
package name and near the top you will see any available vignettes.</p>
<div class="section level3">
<h3 id="installing-packages">Installing packages<a class="anchor" aria-label="anchor" href="#installing-packages"></a>
</h3>
<p>As mentioned above, blaseRtemplates-based projects use a user-project
library that is linked to specific package versions in the main cache.
This way, each project you start can use its own set of packages without
duplication of the actual software. The best way to install packages in
this format is this:</p>
<ul>
<li>Install a new package or get the latest version from a
repository</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/install_one_package.html" class="external-link">install_one_package</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"&lt;package_name&gt;"</span>, how <span class="op">=</span> <span class="st">"new_or_update"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Get a fresh link to the newest version available in the cache</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/install_one_package.html" class="external-link">install_one_package</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"&lt;package_name&gt;"</span>, how <span class="op">=</span> <span class="st">"link_from_cache"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Get a specific version from the cache</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/install_one_package.html" class="external-link">install_one_package</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"&lt;package_name&gt;"</span>, how <span class="op">=</span> <span class="st">"link_from_cache"</span>, which_version <span class="op">=</span> <span class="st">"1.0.0"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Versioned package installations are supported for cran only. If
unavailable, the latest version will be installed.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/install_one_package.html" class="external-link">install_one_package</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"&lt;cran_package_name&gt;"</span>, how <span class="op">=</span> <span class="st">"new_or_update"</span>, which_version <span class="op">=</span> <span class="st">"1.0.0"</span><span class="op">)</span></span></code></pre></div>
<p>You can find a human-readable table with all of the packages in the
cache at BLASERTEMPLATES_CACHE_ROOT/package_catalog.tsv. Each package in
the cache is “hashed”. This means that even if there are two different
versions of the same package that share the same version number, you can
still tell them apart and install the one you need.</p>
<p>This shouldn’t happen but it can if someone updates a package but
forgets to increment the version number.</p>
<ul>
<li>Install a specific hash of a package</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/install_one_package.html" class="external-link">install_one_package</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"&lt;cran_package_name&gt;"</span>, how <span class="op">=</span> <span class="st">"new_or_update"</span>, which_hash <span class="op">=</span> <span class="st">"72f8712f97416089ade12df29386b80b"</span><span class="op">)</span></span></code></pre></div>
<p>You can find a human-readable table with all of the packages used by
a given project in the library_catalogs directory of the project. There
is at least one file in there. For projects collaborating through git,
there will be one for each user. These files indicate all available and
actively used packages in the R code. This file is meant to be tracked
by git and so can provide version control and reproducibility for the
packages used in your project. If you and a collaborator are getting
different results or errors, you can use this to see exactly which
package set you are working with.</p>
</div>
<div class="section level3">
<h3 id="get-a-new-project-library">Get a new project library<a class="anchor" aria-label="anchor" href="#get-a-new-project-library"></a>
</h3>
<p>You can use this function to replace the entire project library with
a new one. By default, the function will install the newest version of
each package available available in the cache.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/get_new_library.html" class="external-link">get_new_library</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Say, however, you want to adopt the entire package library used by a
collaborator on the project (or one from your past self, retrieved from
git), supply their project library catalog as the argument to
<code><a href="https://blaserlab.github.io/blaseRtemplates/reference/get_new_library.html" class="external-link">get_new_library()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/get_new_library.html" class="external-link">get_new_library</a></span><span class="op">(</span><span class="st">"library_catalogs/&lt;file&gt;.tsv"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="extra-credit-basic-git-operation-for-the-single-user">Extra credit: Basic git operation for the single user<a class="anchor" aria-label="anchor" href="#extra-credit-basic-git-operation-for-the-single-user"></a>
</h2>
<p>You want to try to use git and github. There is a vast array of
resources for you to read about git and troubleshoot issues. Briefly, it
is a program that tracks changes to text files. Since all of the code
you will write is text-based this is a great resource for you to keep
track of your progress on your work.</p>
<p>Git tracks changes to files in a group of files known as a
repository. The way we are using it here, your project is the
repository. Github is simply a website that hosts a copy of your
repository on the web. This is how you will share your work with journal
reviewers and editors and others.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make sure you have a github account</span></span>
<span><span class="co"># https://github.com/join</span></span>
<span></span>
<span><span class="co"># install git</span></span>
<span><span class="co">## Windows -&gt;  https://git-scm.com/download/win</span></span>
<span><span class="co">## Mac     -&gt;  https://git-scm.com/download/mac</span></span>
<span><span class="co">## Linux   -&gt;  https://git-scm.com/download/linux</span></span>
<span></span>
<span><span class="co"># configure git in Rstudio</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_git_config.html" class="external-link">use_git_config</a></span><span class="op">(</span>user.name <span class="op">=</span> <span class="st">"YourName"</span>,</span>
<span>                        user.email <span class="op">=</span> <span class="st">"your@mail.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a personal access token at the github website</span></span>
<span><span class="co"># set the expiration date as desired (no expiration date)</span></span>
<span><span class="co"># permissions should be set automatically.  Then run:</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/github-token.html" class="external-link">create_github_token</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run this and enter your token at the prompt</span></span>
<span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu">gitcreds_set</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the following once per user to collaborate smoothly</span></span>
<span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/setup_git_collab.html" class="external-link">setup_git_collab</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Connecting/authenticating to github is the most difficult part of all
of this. The keychain program used by <code>gitcreds_set()</code> may
not be available or working on all systems. As a workaround, you can
replace the line in your .Renviron file,
GITHUB_PAT=gitcreds::gitcreds_get(use_cache = FALSE)$password, with
GITHUB_PAT=<your token>. There is a small security risk to this if
someone were to gain access to your .Renviron file. So proceed with
caution.</your></p>
<p>The necessary permissions should be set automatically by these
commands. By default, the token expires after 30 days, but you can
override this.</p>
<p>Assuming the commands above have run properly you should be ready to
use git and github. You can interact with git in at least 4 different
ways:</p>
<ul>
<li>via scripted commands on <code>R/git_commands.R</code>
</li>
<li>using the Git pane in Rstudio</li>
<li>using the terminal</li>
<li>using a third-party git client such as <a href="https://www.gitkraken.com/" class="external-link">git kraken</a> or <a href="https://www.sourcetreeapp.com/" class="external-link">sourcetree</a>
</li>
</ul>
<p>My recommended approach for new users is to use the scripted git
commands to control what is happening and to use the Git pane to monitor
the status of your repository. Just remember to hit the refresh icon if
things look strange in the Git panel.</p>
<p>At times you will need to use the terminal to fix conflicts, but this
should only happen if you are collaborating with git.</p>
<p>Many people use third-party apps, but these have their own learning
curve.</p>
<p>The basic process for using Git as a single user is this:</p>
<ul>
<li>save all of your open files</li>
<li>check the status of your repository so you know what files have
changed</li>
<li>add them to the Git index of files</li>
<li>commit them to create a save point for all of the files in your
project</li>
<li>push the commit to the remote repository (github)</li>
</ul>
<p>Here are the commands from <code>git_commands.R</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># basic everyday commands for all git users -------------------------------</span></span>
<span> </span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_status</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_add</a></span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span></span>
<span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_commit</a></span><span class="op">(</span><span class="st">"a short comment describing the changes made"</span><span class="op">)</span></span>
<span><span class="fu">blaseRtemplates</span><span class="fu">::</span><span class="fu"><a href="https://blaserlab.github.io/blaseRtemplates/reference/git_push_all.html" class="external-link">git_push_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>That is it!</p>
<p>If you run into problems, the error messages are usually informative.
If you have trouble understanding an error or it isn’t helpful, just
google it.</p>
<p>One common use-case for git for the single user is to “un-delete”
files. You can do this as long as the files were previously committed.
To go back in time and recover the previously committed version, first
make a commit to create a save point and then in the terminal run
<code>git log</code> to review your commit history. Add and commit any
outstanding changes to your repository as outlined above. Then run
<code>git checkout &lt;commit id&gt;</code> to rewind the state of your
repository to the desired commit. Copy the file(s) you want to resurrect
to a location external to the repository. Run <code>git switch -</code>
to go back to your latest commit. Make your changes and go from
there.</p>
<p>Here is a way that is even easier and doesn’t require using the
terminal: go to your github site for that repo. Click on clock icon
labled “commits” (which helpfully includes a “back in time” arrow). Then
select from the list of commits (versions). Click browse files and find
what you were looking for. You can even click on the raw version to copy
and paste directly back into R studio.</p>
<p>Here’s a more complicated situation most of us can relate to:</p>
<ul>
<li>You submit your beautiful manuscript to Journal A</li>
<li>Journal A bounces it right back to you</li>
<li>You reformat all of the figures for your paper in R and submit it to
Journal B</li>
<li>Journal B is more interested, and they send it out for review and 6
weeks later reject it.</li>
<li>You decide to submit to Journal C which has similar figure
formatting as does Journal A.</li>
<li>What do you do?</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run these commands to rewind to a prior "good" commit ----------------------</span></span>
<span></span>
<span><span class="co"># make sure git status is "clean" (all changes committed) before rewinding</span></span>
<span><span class="co"># gert::git_log() #find the id of the good commit</span></span>
<span><span class="co"># blaseRtemplates::git_rewind_to(commit = "&lt;good commit id&gt;")</span></span></code></pre></div>
<p>Hopefully you have a commit in your git log with the message
“submitted to Journal A”. You select that id (the long character string)
and provide it to the <code><a href="https://blaserlab.github.io/blaseRtemplates/reference/git_rewind_to.html" class="external-link">blaseRtemplates::git_rewind_to()</a></code>
function. This function will generate a new commit that reverses all of
your changes from present, back to the indicated commit. Nothing is lost
or overwritten in the process of going back in time. The only thing that
happens is that inverse changes are applied. So if you need to go to
Journal D (which is formatted like Journal B) you can always do that
later.</p>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<p>Use the code blocks from this vignette to make a new R project on
your system and for extra credit push it to github.</p>
<ul>
<li>First, establish the blaseRtemplates installation</li>
<li>Next create a new project</li>
<li>Connect your system to your github account using the git_commands.R
script</li>
<li>Last, run through the initialization script and delete it</li>
</ul>
</li>
<li><p>Explore the scripts in the R directory.</p></li>
<li><p>Try running the code in dependencies.R to install some
recommended packages.</p></li>
<li><p>For more extra credit: save your work, then add, commit, and push
to your github site.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brad Blaser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
